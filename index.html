<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basket SÃ¡zky</title>

<style>
* { box-sizing: border-box; }

body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    background: #0f0f14;
    color: white;
}

.container {
    max-width: 500px;
    margin: auto;
    padding: 15px;
}

h1 {
    text-align: center;
    margin-bottom: 20px;
}

.card {
    background: #1c1c24;
    padding: 15px;
    border-radius: 18px;
    margin-bottom: 20px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.4);
}

input {
    width: 100%;
    padding: 12px;
    border-radius: 12px;
    border: none;
    margin-bottom: 10px;
    font-size: 15px;
}

button {
    width: 100%;
    padding: 12px;
    border-radius: 14px;
    border: none;
    font-weight: bold;
    font-size: 15px;
    cursor: pointer;
    margin-bottom: 8px;
}

.primary { background: #ff9500; color: black; }
.teamBtn { background: #2c2c38; color: white; }
.teamBtn:hover { background: #3a3a4a; }
.deleteBtn { background: #ff3b30; color: white; }

.disabled {
    background: #555 !important;
    cursor: not-allowed;
}

.bet {
    background: #2a2a36;
    padding: 8px;
    border-radius: 10px;
    margin-top: 5px;
}

.winner { background: #1f7a1f; }

.scoreboard {
    background: #1c1c24;
    padding: 15px;
    border-radius: 18px;
}
</style>
</head>

<body>
<div class="container">

<h1>ğŸ€ Basket SÃ¡zky</h1>

<div class="card">
    <input type="text" id="team1" placeholder="TÃ½m 1">
    <input type="text" id="team2" placeholder="TÃ½m 2">
    <button class="primary" onclick="createMatch()">VytvoÅ™it zÃ¡pas</button>
</div>

<div id="matches"></div>

<div class="scoreboard">
    <h2>ğŸ† CelkovÃ© skÃ³re</h2>
    <div id="totalScores"></div>
</div>

</div>

<script>
let matches = JSON.parse(localStorage.getItem("matches")) || [];
let totalScores = JSON.parse(localStorage.getItem("totalScores")) || {};

function saveData() {
    localStorage.setItem("matches", JSON.stringify(matches));
    localStorage.setItem("totalScores", JSON.stringify(totalScores));
}

const team1Input = document.getElementById("team1");
const team2Input = document.getElementById("team2");

function createMatch() {
    const team1 = team1Input.value;
    const team2 = team2Input.value;
    if (!team1 || !team2) return;

    matches.push({
        team1,
        team2,
        bets: [],
        finished: false,
        winner: null,
        locked: false
    });

    team1Input.value = "";
    team2Input.value = "";
    saveData();
    render();
}

function deleteMatch(index) {
    if (!confirm("Opravdu chceÅ¡ smazat tento zÃ¡pas?")) return;

    matches.splice(index, 1);
    saveData();
    render();
}

function addBet(index, team) {
    if (matches[index].locked) return;

    const player = document.getElementById("player"+index).value;
    if (!player) return;

    matches[index].bets.push({ player, tip: team });
    matches[index].locked = true; // ğŸ”’ uzamkne po prvnÃ­m tipu

    saveData();
    render();
}

function setResult(index) {
    const score1 = parseInt(document.getElementById("score1_"+index).value);
    const score2 = parseInt(document.getElementById("score2_"+index).value);
    if (isNaN(score1) || isNaN(score2)) return;

    const match = matches[index];
    match.finished = true;

    if (score1 > score2) match.winner = match.team1;
    else if (score2 > score1) match.winner = match.team2;
    else match.winner = "RemÃ­za";

    if (match.winner !== "RemÃ­za") {
        match.bets.forEach(b => {
            if (b.tip === match.winner) {
                if (!totalScores[b.player]) totalScores[b.player] = 0;
                totalScores[b.player]++;
            }
        });
    }

    saveData();
    render();
}

function render() {
    const container = document.getElementById("matches");
    container.innerHTML = "";

    matches.forEach((match, index) => {
        const card = document.createElement("div");
        card.className = "card";

        let betsHTML = match.bets.map(b => {
            let cls = (match.finished && b.tip === match.winner) ? "bet winner" : "bet";
            return `<div class="${cls}">${b.player} â†’ ${b.tip}</div>`;
        }).join("");

        card.innerHTML = `
            <h2>${match.team1} ğŸ†š ${match.team2}</h2>

            ${!match.finished ? `
                <input type="text" id="player${index}" placeholder="JmÃ©no">

                <button class="teamBtn ${match.locked ? "disabled" : ""}"
                    onclick="addBet(${index}, '${match.team1}')">
                    ${match.team1}
                </button>

                <button class="teamBtn ${match.locked ? "disabled" : ""}"
                    onclick="addBet(${index}, '${match.team2}')">
                    ${match.team2}
                </button>

                ${match.locked ? "<div style='text-align:center;margin:8px;'>ğŸ”’ SÃ¡zky uzamÄeny</div>" : ""}

                <input type="number" id="score1_${index}" placeholder="SkÃ³re ${match.team1}">
                <input type="number" id="score2_${index}" placeholder="SkÃ³re ${match.team2}">
                <button class="primary" onclick="setResult(${index})">UkonÄit zÃ¡pas</button>
            ` : `
                <h3>ğŸ† VÃ­tÄ›z: ${match.winner}</h3>
            `}

            ${betsHTML}

            <button class="deleteBtn" onclick="deleteMatch(${index})">
                ğŸ—‘ Smazat zÃ¡pas
            </button>
        `;

        container.appendChild(card);
    });

    renderTotalScores();
}

function renderTotalScores() {
    const div = document.getElementById("totalScores");
    div.innerHTML = "";

    const sorted = Object.entries(totalScores).sort((a,b) => b[1]-a[1]);

    sorted.forEach(([player, score]) => {
        div.innerHTML += `<div class="bet">${player} - ${score} bodÅ¯</div>`;
    });
}

render();
</script>

</body>
</html>
